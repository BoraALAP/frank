{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/artticfox/Desktop/Work/frank/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/artticfox/Desktop/Work/frank/frontend/pages/sub/dealerfinder.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query DEALER_QUERY($search: String) {\\n      allDealers(where: { city_contains: $search }) {\\n        postal\\n        city\\n        venue{\\n          formattedAddress\\n          googlePlaceID\\n          lat\\n          lng\\n        }\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { gql, useQuery } from \"@apollo/client\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { GoogleMap // useLoadScript,\n// MarkerClusterer,\n, Marker, InfoWindow } from \"react-google-maps\";\nimport Loading from \"../../components/global/Loading\";\nvar DEALER_QUERY = gql(_templateObject());\n\nvar DealerFinder = function DealerFinder(props) {\n  _s();\n\n  var _useQuery = useQuery(DEALER_QUERY),\n      data = _useQuery.data,\n      loading = _useQuery.loading;\n\n  var _useState = useState(data),\n      locations = _useState[0],\n      setLocations = _useState[1];\n\n  var _useState2 = useState(undefined),\n      categories = _useState2[0],\n      setCategories = _useState2[1];\n\n  var _useState3 = useState({}),\n      center = _useState3[0],\n      setCenter = _useState3[1];\n\n  var _useState4 = useState(undefined),\n      activeLocation = _useState4[0],\n      setActiveLocation = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      search = _useState5[0],\n      setSearch = _useState5[1];\n\n  var _useState6 = useState(10),\n      zoom = _useState6[0],\n      setZoom = _useState6[1];\n\n  useEffect(function () {\n    navigator.geolocation.getCurrentPosition(function (position) {\n      if (position) {\n        setCenter({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        });\n      } else {\n        setCenter({\n          lat: 43.6539697,\n          lng: -79.4338794\n        });\n      }\n    });\n  }, []);\n  useEffect(function () {\n    if (!loading) {\n      var _data$dealersConnecti;\n\n      setLocations(data.allDealers);\n      setCategories(data === null || data === void 0 ? void 0 : (_data$dealersConnecti = data.dealersConnection) === null || _data$dealersConnecti === void 0 ? void 0 : _data$dealersConnecti.edges.map(function (_ref) {\n        var node = _ref.node;\n        return node.city;\n      }).filter(function (value, index, self) {\n        return self.indexOf(value) === index;\n      }).sort());\n    }\n  }, [data]);\n  var containerStyle = {\n    width: \"100%\",\n    height: \"90vh\",\n    maxHeight: \"50vh\"\n  };\n  var mapOptions = {\n    imagePath: \"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m\"\n  };\n\n  var HandleSetup = function HandleSetup(loc, index) {\n    // setInfo({ ...loc, index });\n    setActiveLocation(index);\n    setCenter({\n      lat: loc.lat,\n      lng: loc.lng\n    });\n    setZoom(16);\n  };\n\n  useEffect(function () {\n    fetchMore({\n      query: DEALER_QUERY,\n      variables: {\n        search: search\n      },\n      updateQuery: function updateQuery(previousResult, _ref2) {\n        var fetchMoreResult = _ref2.fetchMoreResult;\n\n        if (!fetchMoreResult) {\n          return previousResult;\n        }\n\n        console.log(previousResult, fetchMoreResult);\n        setCategories(fetchMoreResult.dealersConnection.edges.map(function (_ref3) {\n          var node = _ref3.node;\n          return node.city;\n        }).filter(function (value, index, self) {\n          return self.indexOf(value) === index;\n        }).sort());\n        setLocations(fetchMoreResult.dealersConnection.edges);\n      }\n    });\n  }, [search]);\n\n  var dealer = function dealer(loc) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        children: loc.dealer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 7\n      }, _this), /*#__PURE__*/_jsxDEV(InRow, {\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          children: \"Address:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 9\n        }, _this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [loc.address, \" \", loc.postal, \" \", loc.city, \" \", loc.province]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 9\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 7\n      }, _this)]\n    }, void 0, true);\n  };\n\n  var _useLoadScript = useLoadScript({\n    googleMapsApiKey: process.env.REACT_APP_MAP_API_KEY,\n    libraries: [\"places\"] // ,\n    // ...otherOptions\n\n  }),\n      isLoaded = _useLoadScript.isLoaded,\n      loadError = _useLoadScript.loadError;\n\n  var opacity = {\n    initial: {\n      x: -10,\n      opacity: 0\n    },\n    animate: {\n      x: 0,\n      opacity: 1\n    },\n    exit: {\n      x: 10,\n      opacity: 0\n    }\n  };\n\n  if (!center.lat || categories === undefined || !isLoaded) {\n    return /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      exitBeforeEnter: true,\n      children: /*#__PURE__*/_jsxDEV(LoadingS, {\n        initial: \"initial\",\n        animate: \"animate\",\n        exit: \"exit\",\n        variants: opacity\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 45\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 12\n    }, _this);\n  }\n\n  console.log(locations);\n  return /*#__PURE__*/_jsxDEV(AnimatePresence, {\n    exitBeforeEnter: true,\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      children: [/*#__PURE__*/_jsxDEV(Left, {\n        initial: \"initial\",\n        animate: \"animate\",\n        exit: \"exit\",\n        variants: opacity,\n        children: /*#__PURE__*/_jsxDEV(Content, {\n          children: categories !== undefined && categories.length > 0 ? categories.map(function (item, index) {\n            return /*#__PURE__*/_jsxDEV(City, {\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: item\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 19\n              }, _this), locations.map(function (_ref4) {\n                var node = _ref4.node;\n\n                if (node.city === item) {\n                  return /*#__PURE__*/_jsxDEV(Dealer, {\n                    active: activeLocation === node.id,\n                    onClick: function onClick() {\n                      setCenter({\n                        lat: node.lat,\n                        lng: node.lng\n                      });\n                      HandleSetup(node, node.id);\n                      window.scrollTo(0, 0);\n                    },\n                    children: dealer(node)\n                  }, node.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 182,\n                    columnNumber: 25\n                  }, _this);\n                }\n              })]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 17\n            }, _this);\n          }) : /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"There is no city with those letters\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 9\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 7\n      }, _this), /*#__PURE__*/_jsxDEV(Right, {\n        initial: \"initial\",\n        animate: \"animate\",\n        exit: \"exit\",\n        variants: opacity,\n        children: /*#__PURE__*/_jsxDEV(Fixed, {\n          children: [/*#__PURE__*/_jsxDEV(H2, {\n            children: \"Ostaco Windows and Doors products are proudly distributed by many retailers across Ontario. Please fill out this form and our team will quickly get back to you with information on your nearest dealer.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 11\n          }, _this), /*#__PURE__*/_jsxDEV(Form, {\n            children: /*#__PURE__*/_jsxDEV(InputS, {\n              type: \"search\",\n              name: \"search\",\n              placeholder: \"Which city are you looking for?\",\n              value: search,\n              onChange: function onChange(e) {\n                return setSearch(e.target.value);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 13\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 11\n          }, _this), center.lat && /*#__PURE__*/_jsxDEV(GoogleMap, {\n            center: center,\n            mapContainerStyle: containerStyle,\n            zoom: zoom,\n            children: [/*#__PURE__*/_jsxDEV(MarkerClusterer, {\n              options: mapOptions,\n              averageCenter: true,\n              children: function children(clusterer) {\n                return locations.map(function (_ref5) {\n                  var node = _ref5.node;\n                  return /*#__PURE__*/_jsxDEV(MarkerS, {\n                    position: node,\n                    clusterer: clusterer,\n                    title: node.name,\n                    active: activeLocation === node.id,\n                    onClick: function onClick() {\n                      return HandleSetup(node, node.id);\n                    }\n                  }, node.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 236,\n                    columnNumber: 21\n                  }, _this);\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, _this), activeLocation && locations && locations.map(function (_ref6) {\n              var node = _ref6.node;\n              return node.id === activeLocation && /*#__PURE__*/_jsxDEV(InfoWindow, {\n                onCloseClick: function onCloseClick() {\n                  return setActiveLocation(undefined);\n                },\n                position: {\n                  lat: node.lat,\n                  lng: node.lng\n                },\n                children: /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                    children: node.dealer\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 258,\n                    columnNumber: 27\n                  }, _this), /*#__PURE__*/_jsxDEV(InRow, {\n                    children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                      children: \"Address:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 261,\n                      columnNumber: 29\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [node.address, \" \", node.postal, \" \", node.city, \" \", node.province]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 262,\n                      columnNumber: 29\n                    }, _this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 27\n                  }, _this)]\n                }, void 0, true)\n              }, node.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 23\n              }, _this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 9\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 7\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 5\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(DealerFinder, \"gBzRG8vGaGjvfGhKCXcN9s8vcnk=\", true, function () {\n  return [useQuery];\n});\n\n_c = DealerFinder;\nvar Container = styled(motion.div).withConfig({\n  displayName: \"dealerfinder__Container\",\n  componentId: \"sc-1ixs21k-0\"\n})([\"display:grid;grid-gap:1.5em;@media (min-width:768px){grid-template-columns:2fr 3fr;}\"]);\n_c2 = Container;\nvar LoadingS = motion.custom(styled(Loading).withConfig({\n  displayName: \"dealerfinder__LoadingS\",\n  componentId: \"sc-1ixs21k-1\"\n})([\"\"]));\n_c3 = LoadingS;\nvar Left = styled(motion.div).withConfig({\n  displayName: \"dealerfinder__Left\",\n  componentId: \"sc-1ixs21k-2\"\n})([\"display:grid;grid-row:2;@media (min-width:768px){grid-row:1;}\"]);\n_c4 = Left;\nvar Right = styled(motion.div).withConfig({\n  displayName: \"dealerfinder__Right\",\n  componentId: \"sc-1ixs21k-3\"\n})([\"display:grid;@media (min-width:768px){position:relative;}\"]);\n_c5 = Right;\nvar H2 = styled.h2.withConfig({\n  displayName: \"dealerfinder__H2\",\n  componentId: \"sc-1ixs21k-4\"\n})([\"font-size:0.875rem;font-weight:400;max-width:450px;\"]);\n_c6 = H2;\nvar Fixed = styled.div.withConfig({\n  displayName: \"dealerfinder__Fixed\",\n  componentId: \"sc-1ixs21k-5\"\n})([\"display:grid;grid-gap:2vh;@media (min-width:768px){position:fixed;width:52.5vw;}\"]);\n_c7 = Fixed;\nvar InputS = styled.input.withConfig({\n  displayName: \"dealerfinder__InputS\",\n  componentId: \"sc-1ixs21k-6\"\n})([\"max-width:450px;\"]);\n_c8 = InputS;\nvar Content = styled.ul.withConfig({\n  displayName: \"dealerfinder__Content\",\n  componentId: \"sc-1ixs21k-7\"\n})([\"list-style:none;padding-inline-start:0px;display:grid;grid-gap:1.5em;h4{margin:16px 0 0;}\"]);\n_c9 = Content;\nvar Dealer = styled.div.withConfig({\n  displayName: \"dealerfinder__Dealer\",\n  componentId: \"sc-1ixs21k-8\"\n})([\"display:grid;grid-gap:0.5em;h6{margin:0;}\"]);\n_c10 = Dealer;\nvar MarkerS = styled(Marker).withConfig({\n  displayName: \"dealerfinder__MarkerS\",\n  componentId: \"sc-1ixs21k-9\"\n})([\"transform:scale(1.1);\"]);\n_c11 = MarkerS;\nvar InRow = styled.div.withConfig({\n  displayName: \"dealerfinder__InRow\",\n  componentId: \"sc-1ixs21k-10\"\n})([\"display:grid;grid-auto-flow:column;justify-content:start;align-items:baseline;grid-gap:1em;\"]);\n_c12 = InRow;\nvar City = styled.div.withConfig({\n  displayName: \"dealerfinder__City\",\n  componentId: \"sc-1ixs21k-11\"\n})([\"h4{grid-column:1/-1;}display:grid;grid-gap:1em;\"]);\n_c13 = City;\nvar Form = styled.form.withConfig({\n  displayName: \"dealerfinder__Form\",\n  componentId: \"sc-1ixs21k-12\"\n})([\"display:grid;\"]);\n_c14 = Form;\nexport default DealerFinder;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13, _c14;\n\n$RefreshReg$(_c, \"DealerFinder\");\n$RefreshReg$(_c2, \"Container\");\n$RefreshReg$(_c3, \"LoadingS\");\n$RefreshReg$(_c4, \"Left\");\n$RefreshReg$(_c5, \"Right\");\n$RefreshReg$(_c6, \"H2\");\n$RefreshReg$(_c7, \"Fixed\");\n$RefreshReg$(_c8, \"InputS\");\n$RefreshReg$(_c9, \"Content\");\n$RefreshReg$(_c10, \"Dealer\");\n$RefreshReg$(_c11, \"MarkerS\");\n$RefreshReg$(_c12, \"InRow\");\n$RefreshReg$(_c13, \"City\");\n$RefreshReg$(_c14, \"Form\");","map":{"version":3,"sources":["/Users/artticfox/Desktop/Work/frank/frontend/pages/sub/dealerfinder.tsx"],"names":["React","useState","useEffect","styled","gql","useQuery","motion","AnimatePresence","GoogleMap","Marker","InfoWindow","Loading","DEALER_QUERY","DealerFinder","props","data","loading","locations","setLocations","undefined","categories","setCategories","center","setCenter","activeLocation","setActiveLocation","search","setSearch","zoom","setZoom","navigator","geolocation","getCurrentPosition","position","lat","coords","latitude","lng","longitude","allDealers","dealersConnection","edges","map","node","city","filter","value","index","self","indexOf","sort","containerStyle","width","height","maxHeight","mapOptions","imagePath","HandleSetup","loc","fetchMore","query","variables","updateQuery","previousResult","fetchMoreResult","console","log","dealer","address","postal","province","useLoadScript","googleMapsApiKey","process","env","REACT_APP_MAP_API_KEY","libraries","isLoaded","loadError","opacity","initial","x","animate","exit","length","item","id","window","scrollTo","e","target","clusterer","name","Container","div","LoadingS","custom","Left","Right","H2","h2","Fixed","InputS","input","Content","ul","Dealer","MarkerS","InRow","City","Form","form"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { gql, useQuery } from \"@apollo/client\";\n\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nimport {\n  GoogleMap,\n  // useLoadScript,\n  // MarkerClusterer,\n  Marker,\n  InfoWindow,\n} from \"react-google-maps\";\nimport Loading from \"../../components/global/Loading\";\n\nconst DEALER_QUERY = gql`\n  query DEALER_QUERY($search: String) {\n      allDealers(where: { city_contains: $search }) {\n        postal\n        city\n        venue{\n          formattedAddress\n          googlePlaceID\n          lat\n          lng\n        }\n      }\n    }\n  }\n`;\n\nconst DealerFinder = (props) => {\n  const { data, loading } = useQuery(DEALER_QUERY);\n\n  const [locations, setLocations] = useState(data);\n  const [categories, setCategories] = useState(undefined);\n  const [center, setCenter] = useState({});\n  const [activeLocation, setActiveLocation] = useState(undefined);\n  const [search, setSearch] = useState(\"\");\n  const [zoom, setZoom] = useState(10);\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition((position) => {\n      if (position) {\n        setCenter({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        });\n      } else {\n        setCenter({\n          lat: 43.6539697,\n          lng: -79.4338794,\n        });\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    if (!loading) {\n      setLocations(data.allDealers);\n\n      setCategories(\n        data?.dealersConnection?.edges\n          .map(({ node }) => node.city)\n          .filter((value, index, self) => self.indexOf(value) === index)\n          .sort()\n      );\n    }\n  }, [data]);\n\n  const containerStyle = {\n    width: \"100%\",\n    height: \"90vh\",\n    maxHeight: \"50vh\",\n  };\n\n  const mapOptions = {\n    imagePath:\n      \"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m\",\n  };\n\n  const HandleSetup = (loc, index) => {\n    // setInfo({ ...loc, index });\n    setActiveLocation(index);\n    setCenter({ lat: loc.lat, lng: loc.lng });\n    setZoom(16);\n  };\n\n  useEffect(() => {\n    fetchMore({\n      query: DEALER_QUERY,\n      variables: {\n        search,\n      },\n      updateQuery: (previousResult, { fetchMoreResult }) => {\n        if (!fetchMoreResult) {\n          return previousResult;\n        }\n\n        console.log(previousResult, fetchMoreResult);\n\n        setCategories(\n          fetchMoreResult.dealersConnection.edges\n            .map(({ node }) => node.city)\n            .filter((value, index, self) => self.indexOf(value) === index)\n            .sort()\n        );\n        setLocations(fetchMoreResult.dealersConnection.edges);\n      },\n    });\n  }, [search]);\n\n  const dealer = (loc) => (\n    <>\n      <h5>{loc.dealer}</h5>\n      <InRow>\n        <h6>Address:</h6>{\" \"}\n        <span>\n          {loc.address} {loc.postal} {loc.city} {loc.province}\n        </span>\n      </InRow>\n\n      {/* <InRow>\n  //       <h6>Contact Person:</h6> <span>{loc.person}</span>\n  //     </InRow>\n  //     <InRow>\n  //       <h6>Email:</h6>{\" \"}\n  //       <a href={`mailto:${loc.email}`}>\n  //         <span>{loc.email}</span>\n  //       </a>\n  //     </InRow>\n  //     {loc.phone && (\n  //       <InRow>\n  //         <h6>Phone:</h6>{\" \"}\n  //         <a href={`tel:${loc.phone}`}>\n  //           <span>{loc.phone}</span>\n  //         </a>\n  //       </InRow>\n  //     )} */}\n    </>\n  );\n\n  const { isLoaded, loadError } = useLoadScript({\n    googleMapsApiKey: process.env.REACT_APP_MAP_API_KEY,\n    libraries: [\"places\"], // ,\n    // ...otherOptions\n  });\n\n  const opacity = {\n    initial: { x: -10, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: 10, opacity: 0 },\n  };\n\n  if (!center.lat || categories === undefined || !isLoaded) {\n    return <AnimatePresence exitBeforeEnter><LoadingS initial=\"initial\"\n    animate=\"animate\"\n    exit=\"exit\"\n    variants={opacity} /></AnimatePresence>;\n  }\n\n  console.log(locations);\n  \n  \n  return (\n    <AnimatePresence exitBeforeEnter>\n      \n    <Container>\n      <Left  initial=\"initial\"\n            animate=\"animate\"\n            exit=\"exit\"\n            variants={opacity}>\n        <Content>\n          {categories !== undefined && categories.length > 0 ? (\n            categories.map((item, index) => {\n              return (\n                <City key={index}>\n                  <h4>{item}</h4>\n                  {locations.map(({ node }) => {\n                    if (node.city === item) {\n                      return (\n                        <Dealer\n                          key={node.id}\n                          active={activeLocation === node.id}\n                          onClick={() => {\n                            setCenter({\n                              lat: node.lat,\n                              lng: node.lng,\n                            });\n                            HandleSetup(node, node.id);\n                            window.scrollTo(0, 0);\n                          }}\n                        >\n                          {dealer(node)}\n                        </Dealer>\n                      );\n                    }\n                  })}\n                </City>\n              );\n            })\n          ) : (\n            <h3>There is no city with those letters</h3>\n          )}\n        </Content>\n      </Left>\n      <Right  initial=\"initial\"\n            animate=\"animate\"\n            exit=\"exit\"\n            variants={opacity}>\n        <Fixed>\n          <H2>\n            Ostaco Windows and Doors products are proudly distributed by many\n            retailers across Ontario. Please fill out this form and our team\n            will quickly get back to you with information on your nearest\n            dealer.\n          </H2>\n          <Form>\n            <InputS\n              type=\"search\"\n              name=\"search\"\n              placeholder=\"Which city are you looking for?\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n            />\n          </Form>\n          {center.lat && (\n            <GoogleMap\n              center={center}\n              mapContainerStyle={containerStyle}\n              zoom={zoom}\n            >\n              <MarkerClusterer options={mapOptions} averageCenter={true}>\n                {(clusterer) =>\n                  locations.map(({ node }) => (\n                    <MarkerS\n                      key={node.id}\n                      position={node}\n                      clusterer={clusterer}\n                      title={node.name}\n                      active={activeLocation === node.id}\n                      onClick={() => HandleSetup(node, node.id)}\n                    />\n                  ))\n                }\n              </MarkerClusterer>\n\n              {(activeLocation && locations) &&\n                locations.map(({ node }) => {\n                  return (\n                    node.id === activeLocation && (\n                      <InfoWindow\n                        onCloseClick={() => setActiveLocation(undefined)}\n                        position={{ lat: node.lat, lng: node.lng }}\n                        key={node.id}\n                      >\n                        <>\n                          <h5>{node.dealer}</h5>\n\n                          <InRow>\n                            <h6>Address:</h6>\n                            <span>\n                              {node.address} {node.postal} {node.city}{\" \"}\n                              {node.province}\n                            </span>\n                          </InRow>\n                        </>\n                      </InfoWindow>\n                    )\n                  );\n                })}\n            </GoogleMap>\n          )}\n        </Fixed>\n      </Right>\n    </Container>\n    </AnimatePresence>\n  );\n};\n\nconst Container = styled(motion.div)`\n  display: grid;\n  grid-gap: 1.5em;\n  @media (min-width: 768px) {\n    grid-template-columns: 2fr 3fr;\n  }\n`;\n\nconst LoadingS = motion.custom(styled(Loading)``)\n\n\nconst Left = styled(motion.div)`\n  display: grid;\n  grid-row: 2;\n  @media (min-width: 768px) {\n    grid-row: 1;\n  }\n`;\n\nconst Right = styled(motion.div)`\n  display: grid;\n  @media (min-width: 768px) {\n    position: relative;\n  }\n`;\n\nconst H2 = styled.h2`\n  font-size: 0.875rem;\n  font-weight: 400;\n  max-width: 450px;\n`;\n\nconst Fixed = styled.div`\n  display: grid;\n  grid-gap: 2vh;\n  @media (min-width: 768px) {\n    position: fixed;\n    width: 52.5vw;\n  }\n`;\n\nconst InputS = styled.input`\n  max-width: 450px;\n`;\n\nconst Content = styled.ul`\n  list-style: none;\n  padding-inline-start: 0px;\n  display: grid;\n  grid-gap: 1.5em;\n  h4 {\n    margin: 16px 0 0;\n  }\n`;\n\nconst Dealer = styled.div`\n  display: grid;\n  grid-gap: 0.5em;\n  h6 {\n    margin: 0;\n  }\n`;\n\nconst MarkerS = styled(Marker)`\n  transform: scale(1.1);\n`;\n\nconst InRow = styled.div`\n  display: grid;\n  grid-auto-flow: column;\n  justify-content: start;\n  align-items: baseline;\n  grid-gap: 1em;\n`;\n\nconst City = styled.div`\n  h4 {\n    grid-column: 1/-1;\n  }\n  display: grid;\n  grid-gap: 1em;\n`;\n\nconst Form = styled.form`\n  display: grid;\n`;\n\nexport default DealerFinder;\n"]},"metadata":{},"sourceType":"module"}