{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/artticfox/Desktop/Work/frank/frontend/pages/sub/dealerfinder.tsx\";\nimport { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { gql, useQuery } from \"@apollo/client\";\nimport { GoogleMap, useLoadScript } from '@react-google-maps/api';\nimport Loading from \"../../components/global/Loading\";\nimport { Container } from \"../../components/layout/Container\";\nconst DEALER_QUERY = gql`\n  query DEALER_QUERY($search: String) {\n    allDealers(where: { OR: [{city_contains_i: $search},{name_contains_i:$search},{postal_contains_i:$search}] }) {\n      postal\n      city\n      name\n      province\n      venue{\n        formattedAddress\n        googlePlaceID\n        lat\n        lng\n      }\n    }\n  }\n`;\nconst containerStyle = {\n  width: '100%',\n  height: '400px'\n};\n\nconst DealerFinder = props => {\n  const {\n    data,\n    loading,\n    error,\n    refetch\n  } = useQuery(DEALER_QUERY, {\n    fetchPolicy: \"cache-and-network\"\n  });\n  const {\n    0: locations,\n    1: setLocations\n  } = useState([]);\n  const {\n    0: searchWord,\n    1: setSearchWord\n  } = useState(\"\");\n  const {\n    0: location,\n    1: setLocation\n  } = useState({\n    lat: -3.745,\n    lng: -38.523\n  });\n  useEffect(() => {\n    //call db\n    !loading && (data === null || data === void 0 ? void 0 : data.allDealers.length) > 0 && setLocations(data === null || data === void 0 ? void 0 : data.allDealers);\n  }, []);\n  useEffect(() => {\n    //update state with new db after search\n    !loading && (data === null || data === void 0 ? void 0 : data.allDealers.length) > 0 && setLocations(data === null || data === void 0 ? void 0 : data.allDealers);\n  }, [searchWord]); //load google map and initilize\n\n  const {\n    isLoaded,\n    loadError\n  } = useLoadScript({\n    googleMapsApiKey: process.env.NEXT_PUBLIC_GOOGLE_MAP_API\n  });\n  if (loading) return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 23\n  }, this);\n  if (error) return `Error! ${error}`;\n\n  if (loadError) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Map cannot be loaded right now, sorry.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 12\n    }, this);\n  }\n\n  const handleChange = e => {\n    e.preventDefault();\n    setSearchWord(e.target.value);\n    refetch({\n      variables: {\n        search: searchWord\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    space: true,\n    padding: true,\n    children: /*#__PURE__*/_jsxDEV(Content, {\n      children: [/*#__PURE__*/_jsxDEV(Left, {\n        children: !loading && locations !== undefined && locations.length !== 0 && locations.map(item => {\n          return /*#__PURE__*/_jsxDEV(Dealer, {\n            children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n              children: item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: item.venue.formattedAddress\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Right, {\n        children: /*#__PURE__*/_jsxDEV(Fixed, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Ostaco Windows and Doors products are proudly distributed by many retailers across Ontario. Please fill out this form and our team will quickly get back to you with information on your nearest dealer.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 11\n          }, this), isLoaded && !loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              onChange: handleChange,\n              value: searchWord\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GoogleMap, {\n              mapContainerStyle: containerStyle,\n              center: location,\n              zoom: 10\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}; // const Container = styled.div`\n//   display: grid;\n//   grid-gap: 1.5em;\n//   @media (min-width: 768px) {\n//     grid-template-columns: 2fr 3fr;\n//   }\n// `;\n// const LoadingS = custom(styled(Loading)``)\n\n\nconst Content = styled.div.withConfig({\n  displayName: \"dealerfinder__Content\",\n  componentId: \"sc-1ixs21k-0\"\n})([\"display:grid;grid-template-columns:1fr 3fr;gap:3rem;\"]);\nconst Left = styled.ul.withConfig({\n  displayName: \"dealerfinder__Left\",\n  componentId: \"sc-1ixs21k-1\"\n})([\"display:grid;gap:3rem;\"]);\nconst Right = styled.div.withConfig({\n  displayName: \"dealerfinder__Right\",\n  componentId: \"sc-1ixs21k-2\"\n})([\"display:grid;@media (min-width:768px){position:relative;}\"]);\nconst H2 = styled.h2.withConfig({\n  displayName: \"dealerfinder__H2\",\n  componentId: \"sc-1ixs21k-3\"\n})([\"font-size:0.875rem;font-weight:400;max-width:450px;\"]);\nconst Fixed = styled.div.withConfig({\n  displayName: \"dealerfinder__Fixed\",\n  componentId: \"sc-1ixs21k-4\"\n})([\"display:grid;grid-gap:2vh;@media (min-width:768px){position:fixed;width:52.5vw;}\"]);\nconst InputS = styled.input.withConfig({\n  displayName: \"dealerfinder__InputS\",\n  componentId: \"sc-1ixs21k-5\"\n})([\"max-width:450px;\"]); // const Content = styled.ul`\n//   list-style: none;\n//   padding-inline-start: 0px;\n//   display: grid;\n//   grid-gap: 1.5em;\n//   h4 {\n//     margin: 16px 0 0;\n//   }\n// `;\n\nconst Dealer = styled.li.withConfig({\n  displayName: \"dealerfinder__Dealer\",\n  componentId: \"sc-1ixs21k-6\"\n})([\"display:grid;grid-gap:0.5em;h6{margin:0;}\"]);\nconst InRow = styled.div.withConfig({\n  displayName: \"dealerfinder__InRow\",\n  componentId: \"sc-1ixs21k-7\"\n})([\"display:grid;grid-auto-flow:column;justify-content:start;align-items:baseline;grid-gap:1em;\"]);\nconst City = styled.div.withConfig({\n  displayName: \"dealerfinder__City\",\n  componentId: \"sc-1ixs21k-8\"\n})([\"h4{grid-column:1/-1;}display:grid;grid-gap:1em;\"]);\nconst Form = styled.form.withConfig({\n  displayName: \"dealerfinder__Form\",\n  componentId: \"sc-1ixs21k-9\"\n})([\"display:grid;\"]);\nexport default DealerFinder;","map":{"version":3,"sources":["/Users/artticfox/Desktop/Work/frank/frontend/pages/sub/dealerfinder.tsx"],"names":["useState","useEffect","styled","gql","useQuery","GoogleMap","useLoadScript","Loading","Container","DEALER_QUERY","containerStyle","width","height","DealerFinder","props","data","loading","error","refetch","fetchPolicy","locations","setLocations","searchWord","setSearchWord","location","setLocation","lat","lng","allDealers","length","isLoaded","loadError","googleMapsApiKey","process","env","NEXT_PUBLIC_GOOGLE_MAP_API","handleChange","e","preventDefault","target","value","variables","search","undefined","map","item","name","venue","formattedAddress","Content","div","Left","ul","Right","H2","h2","Fixed","InputS","input","Dealer","li","InRow","City","Form","form"],"mappings":"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","sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\nimport styled from \"styled-components\";\nimport { gql, useQuery } from \"@apollo/client\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { GoogleMap, useLoadScript } from '@react-google-maps/api';\n\nimport Loading from \"../../components/global/Loading\";\nimport { Container } from \"../../components/layout/Container\";\n\nconst DEALER_QUERY = gql`\n  query DEALER_QUERY($search: String) {\n    allDealers(where: { OR: [{city_contains_i: $search},{name_contains_i:$search},{postal_contains_i:$search}] }) {\n      postal\n      city\n      name\n      province\n      venue{\n        formattedAddress\n        googlePlaceID\n        lat\n        lng\n      }\n    }\n  }\n`;\n\nconst containerStyle = {\n  width: '100%',\n  height: '400px'\n};\n\n\n\nconst DealerFinder = (props) => {\n  const { data, loading, error, refetch} = useQuery(DEALER_QUERY,{\n    fetchPolicy: \"cache-and-network\"\n  })\n  const [locations, setLocations] = useState([])\n  const [searchWord, setSearchWord] = useState(\"\")\n  const [location, setLocation] = useState({lat: -3.745,\n    lng: -38.523})\n\n  useEffect(() => {\n    //call db\n    !loading && data?.allDealers.length > 0 && setLocations(data?.allDealers)\n  }, [])\n\n  useEffect(() => {\n    //update state with new db after search\n    !loading && data?.allDealers.length > 0 && setLocations(data?.allDealers)\n  },[searchWord])\n\n  //load google map and initilize\n  const { isLoaded, loadError } = useLoadScript({\n    googleMapsApiKey: process.env.NEXT_PUBLIC_GOOGLE_MAP_API,\n  })\n\n  if (loading) return <Loading />;\n  if (error) return `Error! ${error}`;\n    \n  if (loadError) {\n    return <div>Map cannot be loaded right now, sorry.</div>\n  }\n\n  const handleChange = (e) => {\n    e.preventDefault();\n    setSearchWord(e.target.value)\n    refetch({variables: { search: searchWord }})\n  }\n\n  return(\n    <Container space padding>\n      <Content>\n      <Left>\n        {(!loading && locations !== undefined && locations.length !== 0 ) &&  \n          locations.map(item => {\n            return (\n            <Dealer>\n              <h6>{item.name}</h6>\n              <p>{item.venue.formattedAddress}</p>\n            </Dealer>\n            )\n          })\n        }\n      </Left>\n      <Right>\n        <Fixed>\n          <p>Ostaco Windows and Doors products are proudly distributed by many retailers across Ontario. Please fill out this form and our team will quickly get back to you with information on your nearest dealer.</p>\n            {(isLoaded && !loading) ? (\n              <>\n                <input type=\"text\" onChange={handleChange} value={searchWord}/>\n                <GoogleMap\n                mapContainerStyle={containerStyle}\n                center={location}\n                zoom={10}\n                >\n                </GoogleMap>\n              </>\n            ) : <Loading /> \n            }\n        </Fixed>\n      </Right>\n      </Content>\n    </Container>\n  )\n}\n\n\n// const Container = styled.div`\n//   display: grid;\n//   grid-gap: 1.5em;\n//   @media (min-width: 768px) {\n//     grid-template-columns: 2fr 3fr;\n//   }\n// `;\n\n// const LoadingS = custom(styled(Loading)``)\n\nconst Content = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 3fr;\n  gap: 3rem;\n`;\n\n\nconst Left = styled.ul`\n  display: grid;\n  gap: 3rem;\n`;\n\nconst Right = styled.div`\n  display: grid;\n  @media (min-width: 768px) {\n    position: relative;\n  }\n`;\n\nconst H2 = styled.h2`\n  font-size: 0.875rem;\n  font-weight: 400;\n  max-width: 450px;\n`;\n\nconst Fixed = styled.div`\n  display: grid;\n  grid-gap: 2vh;\n  @media (min-width: 768px) {\n    position: fixed;\n    width: 52.5vw;\n  }\n`;\n\nconst InputS = styled.input`\n  max-width: 450px;\n`;\n\n// const Content = styled.ul`\n//   list-style: none;\n//   padding-inline-start: 0px;\n//   display: grid;\n//   grid-gap: 1.5em;\n//   h4 {\n//     margin: 16px 0 0;\n//   }\n// `;\n\nconst Dealer = styled.li`\n  display: grid;\n  grid-gap: 0.5em;\n  h6 {\n    margin: 0;\n  }\n`;\n\nconst InRow = styled.div`\n  display: grid;\n  grid-auto-flow: column;\n  justify-content: start;\n  align-items: baseline;\n  grid-gap: 1em;\n`;\n\nconst City = styled.div`\n  h4 {\n    grid-column: 1/-1;\n  }\n  display: grid;\n  grid-gap: 1em;\n`;\n\nconst Form = styled.form`\n  display: grid;\n`;\n\nexport default DealerFinder;\n"]},"metadata":{},"sourceType":"module"}